# 課前操作指南

**適用對象**：準備正式開課的教練/助教
**目的**：從測試環境切換到正式課程環境
**預估時間**：15-20 分鐘

---

## 📋 準備清單

在開始之前，請確認：
- [ ] ✅ 已確定課程開始日期
- [ ] ✅ 已收集所有學員的姓名
- [ ] ✅ 已測試過完整流程（表單、工作表、儀表板都能正常運作）
- [ ] ✅ 已設定好自動觸發器（每天自動更新連續天數）

---

## 🔧 步驟 1: 清空測試資料

### 1.1 執行清空腳本

1. 開啟 Google Sheet「5週復盤陪跑班 - 打卡數據」
2. 點擊「擴充功能」→「Apps Script」
3. 在函數下拉選單選擇：`clearTestData()`
4. 點擊「執行」（播放按鈕）
5. 確認刪除

**結果**：
- ✅ 「表單回應」工作表已清空（保留標題列）
- ✅ 「學員名單」工作表已清空（保留標題列）
- ✅ 「打卡統計」工作表的數據已清空

### 1.2 驗證清空結果

檢查以下工作表：
- **表單回應**：只有標題列（時間戳記、電子郵件地址、姓名...）
- **學員名單**：只有標題列（姓名、加入日期、狀態、備註）
- **打卡統計**：只有標題列（姓名、累計打卡天數...）
- **每日亮點牆**：只有標題列（日期、姓名、一句話亮點...）

---

## 👥 步驟 2: 輸入真實學員名單

### 2.1 在「學員名單」工作表輸入

| A (姓名) | B (加入日期) | C (狀態) | D (備註) |
|---------|------------|---------|---------|
| 張三 | 2026-01-13 | 在班 | |
| 李四 | 2026-01-13 | 在班 | |
| 王五 | 2026-01-13 | 在班 | |
| ... | ... | ... | |

**方式 1：手動輸入**
- 逐行輸入學員姓名
- 加入日期填入課程開始日期
- 狀態預設為「在班」

**方式 2：匯入 CSV**（推薦）
1. 準備 CSV 檔案，格式如上表
2. 在「學員名單」工作表點擊「檔案」→「匯入」
3. 選擇你的 CSV 檔案
4. 匯入位置：「附加至目前工作表」
5. 點擊「匯入資料」

### 2.2 重要提醒

⚠️ **姓名必須和 Google Form 下拉選單一致**，否則無法統計！

例如：
- ✅ 正確：學員名單是「張三」，Form 也是「張三」
- ❌ 錯誤：學員名單是「張三」，Form 是「張 三」（多了空格）

---

## 📝 步驟 3: 更新 Google Form 的姓名下拉選單

### 3.1 手動更新（適合學員少於 30 人）

1. 開啟 Google Form「5週復盤陪跑班 - 每日打卡」
2. 點擊「姓名」欄位進行編輯
3. 將測試用的選項（學員001, 學員002...）改為真實姓名
4. 儲存

### 3.2 從試算表自動同步（適合學員多於 30 人）

使用 Google Form 的「從試算表自動填入選項」功能（需要額外設定）：

1. 在 Google Form 中，編輯「姓名」欄位
2. 點擊右側的「⋮」→「從試算表自動填入選項」
3. 選擇「5週復盤陪跑班 - 打卡數據」
4. 選擇「學員名單」工作表
5. 選擇「姓名」欄位（A 欄）
6. 儲存

**優點**：以後新增學員只需在「學員名單」新增，Form 會自動更新。

---

## 🎨 步驟 4: 修改儀表板的課程開始日期

### 4.1 找到配置區

開啟 `dashboard-wired.html`，找到第 930-932 行：

```javascript
// 課程開始日期（配合 35 天測試資料）
// 如果今天是 2026-01-09，35 天前是 2025-12-06
const COURSE_START_DATE = new Date('2025-12-06');
```

### 4.2 修改為正式開課日期

假設你的課程從 **2026-01-13** 開始：

```javascript
// 課程開始日期（正式課程）
const COURSE_START_DATE = new Date('2026-01-13');
```

⚠️ **注意日期格式**：YYYY-MM-DD（年-月-日），例如：
- 2026-01-13（2026 年 1 月 13 日）
- 2026-02-01（2026 年 2 月 1 日）

### 4.3 確認測試模式已關閉

確認第 936 行的設定：

```javascript
const TEST_TODAY_DATE = null; // 設為 null 使用真實日期
```

✅ **正確**：`null`（使用真實今天日期）
❌ **錯誤**：`new Date('2026-01-09')`（固定測試日期）

### 4.4 儲存並推送到 GitHub

```bash
git add dashboard-wired.html
git commit -m "Update: 設定正式課程開始日期為 2026-01-13"
git push
```

等待 1-2 分鐘，GitHub Pages 會自動更新。

---

## ⚙️ 步驟 5: 設定自動觸發器（推薦）

### 5.1 為什麼需要自動觸發器？

連續打卡天數需要每天計算更新。如果不設定自動觸發器，必須每天手動執行 `updateAllConsecutiveDays()`。

### 5.2 設定方法（推薦：每天執行 3 次）

1. 在 Apps Script 編輯器左側，點擊「觸發條件」（⏰ 時鐘圖示）
2. 點擊「+ 新增觸發條件」
3. 設定第 1 個觸發器：

| 欄位 | 設定值 |
|-----|--------|
| 選擇要執行的函式 | `updateAllConsecutiveDays` |
| 選擇活動來源 | `時間驅動` |
| 選取時間型觸發條件類型 | `日計時器` |
| 選取時段 | `上午 7 時至 8 時` |

4. 點擊「儲存」
5. 重複步驟 2-4，建立第 2 和第 3 個觸發器：
   - 第 2 個：`下午 1 時至 2 時`
   - 第 3 個：`晚上 11 時至午夜 12 時`

### 5.3 為什麼是 3 次？

- **上午 8:00**：學員開始打卡前更新昨日數據
- **下午 14:00**：中午休息時段更新
- **晚上 23:00**：一天結束前最後更新

### 5.4 驗證觸發器

1. 在「觸發條件」頁面，應該看到 3 個觸發器
2. 每個觸發器都顯示「已啟用」
3. 點擊「執行記錄」查看執行狀態

---

## ✅ 步驟 6: 測試完整流程

### 6.1 請一位學員測試打卡

1. 將 Google Form 連結分享給一位學員
2. 請他填寫今天的打卡資料
3. 提交表單

### 6.2 檢查 Google Sheet

開啟「表單回應」工作表，應該看到：
- ✅ 時間戳記（提交時間）
- ✅ 學員的電子郵件地址
- ✅ 學員姓名
- ✅ 打卡日期
- ✅ 完成狀態（✅ 是，已完成）
- ✅ 一句話亮點
- ✅ 萃取法
- ✅ 額外分享

### 6.3 執行更新連續天數

在 Apps Script 執行：
```
updateAllConsecutiveDays()
```

### 6.4 檢查「打卡統計」工作表

應該看到該學員的：
- ✅ 累計打卡天數：1
- ✅ 連續打卡天數：1
- ✅ 最近打卡日期：今天日期
- ✅ 里程碑：尚未達成（都是 -）

### 6.5 檢查儀表板

重新整理 `https://YOUR_USERNAME.github.io/checkin-dashboard/`

應該看到：
- ✅ 課程總覽顯示「第 1 天」（假設今天是開課第一天）
- ✅ 今日打卡率：1/N 人（N 是總學員數）
- ✅ 今日打卡動態：1 人已打卡
- ✅ 打卡熱力圖：第 1 天有顏色（其他天是灰色）
- ✅ 每日亮點牆：顯示該學員的分享
- ✅ 連續打卡王：該學員排第 1（1 天）

---

## 📊 步驟 7: 分享儀表板給學員

### 7.1 取得儀表板網址

你的儀表板網址格式：
```
https://YOUR_USERNAME.github.io/checkin-dashboard/
```

例如：`https://chichu.github.io/checkin-dashboard/`

### 7.2 在哪裡分享？

建議將網址加到：
- ✅ **Google Form 的確認訊息**：「✅ 打卡成功！[點此查看儀表板](https://...)」
- ✅ **LINE 群組的置頂訊息**：「📊 打卡儀表板：https://...」
- ✅ **課程網站的導覽列**：加入「打卡儀表板」連結
- ✅ **每日提醒訊息**：「記得打卡！查看儀表板：https://...」

### 7.3 更新 Google Form 的確認訊息

1. 開啟 Google Form
2. 點擊右上角「⚙️ 設定」
3. 切換到「簡報」分頁
4. 修改確認訊息：

```
✅ 打卡成功！記得到儀表板看看其他同學的分享！

📊 儀表板：https://YOUR_USERNAME.github.io/checkin-dashboard/
🔥 今日打卡動態、連續打卡王排行榜、每日亮點牆都在等你！
```

5. 儲存

---

## 🎯 完整檢查清單

請確認以下所有項目都已完成：

### Google Sheet 設定
- [ ] ✅ 測試資料已清空（執行 `clearTestData()`）
- [ ] ✅ 真實學員名單已輸入「學員名單」工作表
- [ ] ✅ 學員名單的姓名格式正確（無多餘空格、全形/半形一致）

### Google Form 設定
- [ ] ✅ 姓名下拉選單已更新為真實學員姓名
- [ ] ✅ 確認訊息已加入儀表板連結

### 儀表板設定
- [ ] ✅ `COURSE_START_DATE` 已設為正式開課日期
- [ ] ✅ `TEST_TODAY_DATE` 設為 `null`
- [ ] ✅ 已推送到 GitHub 並部署

### Apps Script 設定
- [ ] ✅ 自動觸發器已設定（每天 3 次更新連續天數）
- [ ] ✅ 觸發器已驗證並啟用

### 測試驗證
- [ ] ✅ 請一位學員測試打卡
- [ ] ✅ 表單回應正確記錄
- [ ] ✅ 執行 `updateAllConsecutiveDays()` 成功
- [ ] ✅ 打卡統計顯示正確
- [ ] ✅ 儀表板顯示正確（第 1 天、打卡率、熱力圖、亮點牆）

### 分享設定
- [ ] ✅ 儀表板網址已分享給學員
- [ ] ✅ LINE 群組已置頂儀表板連結
- [ ] ✅ Google Form 確認訊息已加入連結

---

## 🚨 常見問題

### Q1: 儀表板顯示「第 0 天」或負數？

**原因**：`COURSE_START_DATE` 設定的日期晚於今天。

**解決**：確認 `COURSE_START_DATE` 是課程開始日期，不是未來日期。

### Q2: 連續打卡天數顯示 0 或負數？

**原因**：
- C 欄有錯誤公式
- 沒有執行 `updateAllConsecutiveDays()`

**解決**：
1. 開啟「打卡統計」工作表
2. 點擊 C 欄標題，按 Delete 清空
3. 在 C1 輸入「連續打卡天數」
4. 執行 `updateAllConsecutiveDays()`

### Q3: 儀表板顯示「載入資料失敗」？

**原因**：Google Sheet 共用設定不正確。

**解決**：
1. 開啟 Google Sheet
2. 點擊「共用」按鈕
3. 改為「知道連結的任何人」
4. 權限設為「檢視者」
5. 點擊「完成」

### Q4: 學員打卡後，儀表板沒有顯示？

**原因**：
- 姓名不一致（學員名單 vs Form）
- 沒有執行 `updateAllConsecutiveDays()`
- 儀表板緩存未更新

**解決**：
1. 檢查「表單回應」的姓名和「學員名單」是否完全一致
2. 執行 `updateAllConsecutiveDays()`
3. 在儀表板按 F12 → Console → 輸入 `localStorage.clear()` → 重新整理

### Q5: 熱力圖沒有顯示顏色？

**原因**：
- 課程尚未開始（都是未來日期）
- 沒有打卡資料

**解決**：
1. 確認 `COURSE_START_DATE` 設定正確
2. 確認「表單回應」有打卡記錄
3. 執行 `updateAllConsecutiveDays()`
4. 重新整理儀表板

---

## 📝 不需要修改的項目

以下項目**不需要修改**，都會自動運作：

❌ **Apps Script 程式碼**
- 所有日期計算都是動態的
- 測試資料生成函數使用 `new Date()` 動態計算

❌ **Google Sheet 的公式**
- 累計打卡天數（B 欄）：自動計算
- 最近打卡日期（D 欄）：自動計算
- 里程碑（E-H 欄）：自動計算
- 每日亮點牆：自動抓取

❌ **儀表板的其他設定**
- CSV 連結（SHEET_ID, STATS_GID, HIGHLIGHTS_GID）：保持不變
- 緩存時間（5 分鐘）：保持不變
- 自動刷新頻率（1 分鐘）：保持不變

---

## 🎉 完成！

恭喜你完成所有課前設定！現在可以：

1. 📱 將 Google Form 連結分享給學員
2. 📊 將儀表板連結分享給學員
3. 🔥 開始你的 35 天習慣養成之旅！

**祝你的陪跑班順利進行！** 💪

---

## 📚 延伸閱讀

- [Phase1-完整指南.md](Phase1-完整指南.md)：完整的 Phase 1 設定教學
- [部署指南-GitHub-Pages.md](部署指南-GitHub-Pages.md)：儀表板部署指南
- [設定自動執行教學.md](設定自動執行教學.md)：自動觸發器詳細設定
- [儀表板使用說明.md](儀表板使用說明.md)：學員使用指南
- [文件索引.md](文件索引.md)：所有文件快速導覽

---

**需要幫助？**
- 檢查各文件的「常見問題」區塊
- 查看 README.md 的「技術棧」說明
- 在 GitHub Issues 回報問題

Happy Coaching! 🚀
