# 自動觸發器頻率建議

## 🎯 快速結論

### 推薦方案：一天 3 次 ⭐

**最佳平衡點：即時性 + 效能 + 意義**

- ⏰ **早上 8:00**：更新昨晚的最終數據
- ⏰ **下午 2:00**：中午補打卡的學員
- ⏰ **晚上 11:00**：**最重要！** 當天打卡高峰後

---

## 📊 各方案比較

| 方案 | 優點 | 缺點 | 適用情境 |
|-----|------|------|---------|
| **每小時（24次/天）** | 最即時 | 意義不大、浪費配額 | ❌ 不推薦 |
| **一天 3 次** ⭐ | 即時性好、有意義 | - | ✅ **最推薦** |
| **一天 2 次** | 簡單、夠用 | 中午補打卡的看不到 | ✅ 可接受 |
| **一天 1 次** | 最省配額 | 不夠即時 | ⚠️ 勉強可用 |

---

## 🤔 為什麼不建議每小時觸發？

### 1. 連續打卡天數是「天」的概念

**範例**：
- 學員在早上 9:00 打卡 → 連續天數 +1
- 之後不管 10:00、11:00、12:00... 再怎麼更新
- 連續天數都還是同一個值，**直到隔天才會變**

### 2. 大部分數據已經是即時的

**即時更新的項目**（學員打卡後立刻顯示）：
- ✅ 累計打卡天數
- ✅ 最近打卡日期
- ✅ 里程碑徽章（7/14/21/35天）
- ✅ 每日亮點牆

**需要定期更新的項目**：
- ⏰ 連續打卡天數 ← **只有這個！**

### 3. 學員使用情境

**學員什麼時候會查看儀表板？**
- 📱 打卡後（看自己的累計天數和亮點牆）→ **已經即時**
- 🏆 晚上睡前（看今天的排行榜）→ **晚上 11 點更新就夠了**
- ☀️ 隔天早上（看昨天最終排名）→ **早上 8 點更新就夠了**

**結論：每小時更新完全沒必要**

---

## 💡 一天 3 次的時間點建議

### 方案 A：標準配置（推薦）

```
早上 8:00  → 昨天的最終排名已確定
下午 2:00  → 中午補打卡的學員也算進來了
晚上 11:00 → 今天打卡高峰結束，最新排名出爐
```

**優點**：
- ✅ 學員早上查看時看到昨天最終排名
- ✅ 中午有補打卡的也能看到
- ✅ 晚上打卡後馬上看到最新排名（11點更新）

### 方案 B：簡化配置（也可以）

```
早上 9:00  → 昨天的最終排名
晚上 11:00 → 今天的最新排名
```

**優點**：
- ✅ 設定簡單
- ✅ 涵蓋最重要的兩個時段
- ⚠️ 但中午補打卡的要等到晚上才看到

---

## 🔧 如何設定

### 方法 1: 使用我提供的腳本（最簡單）

1. **開啟 Apps Script 編輯器**
   - 在 Google Sheet 點擊「擴充功能」→「Apps Script」

2. **複製腳本**
   - 開啟 `設定多個自動觸發器.js`
   - 全選並複製內容
   - 貼到 Apps Script 編輯器最下方

3. **執行設定函數**
   - 函數下拉選單選擇 `createMultipleDailyTriggers`（一天3次）
   - 或選擇 `createTwiceDailyTriggers`（一天2次）
   - 點擊「執行」
   - 授權後完成

4. **完成！**
   - 看到成功訊息即可

### 方法 2: 手動設定（傳統方式）

1. 在 Apps Script 編輯器左側點擊「觸發條件」
2. 點擊「+ 新增觸發條件」
3. 設定第 1 個：
   - 函式：`updateAllConsecutiveDays`
   - 事件來源：時間驅動
   - 類型：日計時器
   - 時段：上午 8 時至 9 時
4. 點擊「儲存」
5. 重複步驟 2-4，建立第 2、3 個觸發器

---

## 📈 配額使用分析

### Google Apps Script 免費版限制

- 每日執行時間：**90 分鐘**
- 單次執行時間：**6 分鐘**

### 各方案配額使用

| 方案 | 執行次數 | 每次時間 | 每日總時間 | 配額使用率 |
|-----|---------|---------|-----------|----------|
| 每小時 | 24 次 | 10 秒 | 4 分鐘 | 4.4% |
| 一天 3 次 | 3 次 | 10 秒 | 30 秒 | 0.6% |
| 一天 2 次 | 2 次 | 10 秒 | 20 秒 | 0.4% |
| 一天 1 次 | 1 次 | 10 秒 | 10 秒 | 0.2% |

**結論：全部都安全，配額完全夠用！**

---

## 🎯 我的最終建議

### 對於 100 位學員的課程：

**一天 3 次（早 8、午 2、晚 11）**

**理由**：
1. ✅ 學員體驗好（早上看到昨天排名、晚上看到今天排名）
2. ✅ 涵蓋補打卡的學員
3. ✅ 配額使用極低（0.6%）
4. ✅ 設定簡單（用我提供的腳本一鍵完成）

### 如果你真的想要更即時：

**每小時觸發也可以**

**但要知道**：
- 大部分數據本來就是即時的
- 連續天數一天內不會變
- 實際意義不大
- 不過配額確實夠，不會有問題

---

## ✅ 設定檢查清單

- [ ] 決定要用哪個方案（推薦：一天 3 次）
- [ ] 複製 `設定多個自動觸發器.js` 到 Apps Script
- [ ] 執行對應的設定函數
- [ ] 在「觸發條件」頁面確認觸發器已建立
- [ ] 等待第一次自動執行
- [ ] 檢查「執行作業」確認成功執行

---

## 🔍 如何查看觸發器狀態

1. **查看已設定的觸發器**
   - Apps Script 編輯器 → 左側「觸發條件」
   - 可以看到所有觸發器和執行時間

2. **查看執行記錄**
   - Apps Script 編輯器 → 左側「執行作業」
   - 可以看到每次執行的時間和結果

3. **使用查看函數**
   - 執行 `viewCurrentTriggers()` 函數
   - 會顯示目前所有觸發器

---

## 💬 常見問題

### Q: 可以混合使用嗎？例如平日每小時、假日一天 1 次？

**不建議**，因為：
- Google Apps Script 觸發器不支援「平日/假日」的條件設定
- 會讓設定變複雜
- 實際意義不大

### Q: 如果我改變主意，想修改觸發頻率怎麼辦？

**很簡單**：
1. 執行 `deleteAllTriggers()` 刪除舊觸發器
2. 執行新的設定函數（例如 `createTwiceDailyTriggers`）
3. 完成！

### Q: 觸發器會自動停止嗎？

**不會**。除非你：
- 手動刪除觸發器
- 刪除 Apps Script 專案
- 連續多次執行失敗（Google 會暫停觸發器並通知你）

### Q: 如果執行失敗會怎樣？

- Google 會寄 Email 通知你
- 觸發器還是會繼續執行（下次執行時間不變）
- 你可以手動執行一次來補上

---

## 🚀 立即行動

**建議做法**：

1. 使用 `createMultipleDailyTriggers()`（一天 3 次）
2. 觀察一週學員的使用情況
3. 如果覺得不夠即時，再調整

**記住**：
- 大部分數據已經是即時的
- 只有連續打卡天數需要定期更新
- 一天 3 次已經非常足夠了

需要協助設定隨時告訴我！ 😊
