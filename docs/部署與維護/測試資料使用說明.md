# 測試資料產生與管理說明

## 📊 新版測試資料說明

更新後的 `generateTestData()` 函數會產生 **過去 35 天** 的測試資料，讓你可以測試所有里程碑功能。

### 測試資料內容

5 位學員，每位有不同的打卡模式：

| 學員 | 連續打卡天數 | 說明 | 可達成里程碑 |
|-----|------------|------|-------------|
| 王小明 | 35 天 | 完美打卡，一天都沒漏 | 🏆🏆🏆🏆 (7/14/21/35天全達成) |
| 李小華 | 約 22 天 | 中間有跳過幾天 | 🏆🏆🏆 (7/14/21天) |
| 張小美 | 約 18 天 | 中間有跳過幾天 | 🏆🏆 (7/14天) |
| 陳大偉 | 約 11 天 | 中間有跳過幾天 | 🏆 (7天) |
| 林小芳 | 約 8 天 | 中間有跳過幾天 | 🏆 (7天) |

**總共約產生 94 筆打卡記錄**

---

## 🔧 使用步驟

### 步驟 1: 更新 Apps Script 代碼

1. 打開 Google Sheet
2. 點擊「擴充功能」→「Apps Script」
3. **刪除所有現有代碼**
4. 開啟本地的 `apps-script-code.js` 文件
5. 全選並複製所有內容 (Cmd+A, Cmd+C)
6. 貼上到 Apps Script 編輯器
7. 點擊「儲存」圖示

### 步驟 2: 清空舊的測試資料（如果有的話）

1. 在 Apps Script 編輯器中
2. 在上方函數下拉選單中選擇 **`clearTestData`**
3. 點擊「執行」（▶️ 播放圖示）
4. 會跳出確認視窗，點擊「是」
5. 等待執行完成，會看到「測試資料已清空」的提示

### 步驟 3: 產生新的測試資料

1. 在上方函數下拉選單中選擇 **`generateTestData`**
2. 點擊「執行」（▶️ 播放圖示）
3. 等待執行完成（約 10-20 秒，因為要產生 94 筆資料）
4. 會看到提示訊息顯示產生的資料統計

### 步驟 4: 驗證資料

切換到各工作表檢查：

#### 「表單回應」工作表
- 應該有約 94 筆記錄
- 日期從 35 天前到今天

#### 「打卡統計」工作表
應該看到：
- 王小明：累計 35 天，連續 35 天，🏆🏆🏆🏆
- 李小華：累計約 22 天，連續天數看最近是否中斷，🏆🏆🏆
- 張小美：累計約 18 天，連續天數看最近是否中斷，🏆🏆
- 陳大偉：累計約 11 天，連續天數看最近是否中斷，🏆
- 林小芳：累計約 8 天，連續天數看最近是否中斷，🏆

#### 「每日亮點牆」工作表
- 應該有約 94 筆亮點記錄
- 依日期降冪排序（最新在最上面）

---

## 🎯 可用的 Apps Script 函數

### 1. `calculateConsecutiveDays(studentName)`
計算學員的連續打卡天數
- 在 Google Sheet 中使用：`=calculateConsecutiveDays(A2)`
- 會自動計算該學員從最近一次打卡往前推的連續天數

### 2. `generateTestData()`
產生測試資料
- 產生過去 35 天，5 位學員的打卡記錄
- 每位學員有不同的打卡模式
- 總共約 94 筆記錄

### 3. `clearTestData()`
清空測試資料
- 刪除「表單回應」工作表中的所有資料（保留標題列）
- 會跳出確認視窗，避免誤刪
- **注意：此操作無法復原！**

---

## ⚠️ 注意事項

1. **執行前先備份**
   - 如果你已經有重要的真實資料，請先備份整個 Google Sheet
   - 清空資料的操作無法復原

2. **授權提醒**
   - 第一次執行函數時，Google 會要求授權
   - 點擊「授權」→ 選擇你的 Google 帳號 → 點擊「允許」

3. **執行時間**
   - `generateTestData()` 需要約 10-20 秒執行
   - 請耐心等待，不要重複點擊執行

4. **資料一致性**
   - 產生測試資料後，「打卡統計」和「每日亮點牆」會自動更新
   - 如果沒有更新，檢查公式是否正確（參考 `URGENT-FIX.md`）

---

## 🐛 疑難排解

### 問題：執行 clearTestData 時出現錯誤
**解決方案**：
- 確認工作表名稱是否為「表單回應」（完全一致，不能有多餘空格）
- 確認已授權 Apps Script

### 問題：產生資料後，累計打卡天數還是 0
**解決方案**：
- 檢查「打卡統計」工作表的公式是否正確
- 參考 `URGENT-FIX.md` 修正公式
- 確認欄位順序：C欄是姓名，E欄是是否完成

### 問題：連續打卡天數顯示不正確
**解決方案**：
- 檢查 Apps Script 中的 `calculateConsecutiveDays` 函數是否已更新
- 重新複製 `apps-script-code.js` 的內容到 Apps Script 編輯器

---

## 📝 下一步

完成測試資料產生後，你就可以：

1. ✅ 驗證所有公式都正確運作
2. ✅ 測試里程碑徽章（7/14/21/35天）
3. ✅ 準備進入 **Phase 2: Vibe 儀表板開發**

需要進入 Phase 2 時請告訴我！
